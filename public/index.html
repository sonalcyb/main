<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DigiCart — E‑Books • PDF Notes • Software • Courses</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{--bg:#0b0b0f;--panel:#121218;--muted:#9ca3af;--text:#f5f7fa;--gold:#f5c542;--gold-2:#e8b02b;--ring:rgba(245,197,66,.25)}
    *{box-sizing:border-box}html,body{height:100%}
    body{margin:0;background:radial-gradient(1200px 800px at 100% -10%, #1a1206 0%, transparent 45%),radial-gradient(800px 600px at -10% 100%, #11141a 0%, transparent 50%),var(--bg);color:var(--text);font-family:Poppins,system-ui,-apple-system,Segoe UI,Roboto}
    .container{max-width:1180px;margin:0 auto;padding:20px}
    header{position:sticky;top:0;z-index:50;backdrop-filter:saturate(140%) blur(8px);background:linear-gradient(180deg,rgba(11,11,15,.8),rgba(11,11,15,.4));border-bottom:1px solid rgba(229,200,71,.15)}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 20px}
    .brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:inherit}
    .logo{width:38px;height:38px;display:grid;place-items:center;border-radius:12px;background:linear-gradient(135deg,#2b210f,#141414);border:1px solid rgba(245,197,66,.25);box-shadow:0 8px 24px rgba(245,197,66,.08) inset}
    .logo svg{width:22px;height:22px;fill:var(--gold)}
    .brand h1{margin:0;font-size:20px;letter-spacing:.4px}
    .tag{font-size:12px;color:var(--muted)}
    .btn{cursor:pointer;border:1px solid rgba(245,197,66,.35);color:#161616;background:var(--gold);padding:10px 14px;border-radius:12px;font-weight:600;transition:.2s;display:inline-flex;align-items:center;gap:10px;text-decoration:none}
    .btn:hover{background:var(--gold-2);transform:translateY(-1px)}
    .btn.ghost{background:transparent;color:var(--text);border-color:rgba(245,197,66,.25)}
    .btn.ghost:hover{border-color:rgba(245,197,66,.55);box-shadow:0 0 0 4px var(--ring)}
    .hero{padding:46px 20px 20px}
    .hero-card{background:linear-gradient(180deg, rgba(245,197,66,.07), transparent 65%), var(--panel); border:1px solid rgba(245,197,66,.15); border-radius:22px; padding:24px; box-shadow:0 12px 40px rgba(0,0,0,.35)}
    .tabs{margin-top:16px;display:flex;gap:10px;flex-wrap:wrap}
    .tab{padding:10px 14px;border-radius:999px;border:1px solid rgba(245,197,66,.25);cursor:pointer;color:#eddca6}
    .tab.active{background:rgba(245,197,66,.15);border-color:rgba(245,197,66,.55)}
    .section{padding:14px 20px 36px}.section h3{font-size:20px;margin:0 0 12px}
    .grid{display:grid;grid-template-columns:repeat(3,minmax(0,1fr));gap:18px}
    @media (max-width:980px){.grid{grid-template-columns:repeat(2,1fr)}}@media (max-width:620px){.grid{grid-template-columns:1fr}}
    .card{position:relative;background:var(--panel);border:1px solid rgba(245,197,66,.12);border-radius:18px;overflow:hidden;box-shadow:0 12px 36px rgba(0,0,0,.35)}
    .thumb{height:150px;background:linear-gradient(135deg,#141414 0%,#20170a 100%);display:grid;place-items:center}
    .thumb svg{width:54px;height:54px;fill:var(--gold);opacity:.9}
    .body{padding:16px}.title{font-weight:600;font-size:16px;margin:0 0 4px}
    .meta{font-size:12px;color:var(--muted)}.row{display:flex;align-items:center;justify-content:space-between;margin-top:12px}
    .price{font-weight:700;color:var(--gold)}.badge{position:absolute;top:10px;left:10px;font-size:11px;background:rgba(245,197,66,.15);border:1px solid rgba(245,197,66,.45);color:#f7d789;padding:6px 10px;border-radius:999px;font-weight:600}
    dialog[open]{display:grid;place-content:center;backdrop-filter:blur(6px)}dialog{border:none;padding:0;background:transparent}
    .modal{width:min(640px,94vw);background:var(--panel);border:1px solid rgba(245,197,66,.2);border-radius:18px;overflow:hidden}
    .modal .head{display:flex;justify-content:space-between;align-items:center;padding:14px 16px;border-bottom:1px solid rgba(245,197,66,.12)}
    .modal .content{padding:16px}.kbd{font-family:ui-monospace,Menlo,monospace;font-size:12px;background:#0f1115;border:1px solid rgba(245,197,66,.25);color:#e7e4d4;padding:2px 6px;border-radius:6px}
    .timer{display:flex;gap:10px;align-items:center;margin-top:8px}.pill{border:1px solid rgba(245,197,66,.35);border-radius:999px;padding:4px 10px;font-weight:600}.disabled{opacity:.5;pointer-events:none}
  </style>
</head>
<body>
  <header>
    <div class="nav container">
      <a href="#" class="brand" aria-label="DigiCart Home">
        <div class="logo" aria-hidden="true"><svg viewBox="0 0 24 24"><path d="M7 18c-1.657 0-3-1.343-3-3V7c0-1.657 1.343-3 3-3h10c1.657 0 3 1.343 3 3v8c0 1.657-1.343 3-3 3H7zm0 0v2a1 1 0 0 0 1.447.894L12 20l3.553.894A1 1 0 0 0 17 20v-2"/></svg></div>
        <div><h1>DigiCart</h1><div class="tag">E‑Books • PDF Notes • Software • Courses</div></div>
      </a>
      <div style="display:flex;gap:10px;align-items:center">
        <a class="btn ghost" href="#sections">Browse</a>
        <a class="btn" href="#how-to-pay">Pay with Razorpay</a>
      </div>
    </div>
  </header>
  <section class="hero">
    <div class="container hero-card">
      <div class="tag" style="color:#eddca6">BLACK & GOLD EDITION</div>
      <h2>Instant digital downloads with Razorpay — UPI, Card, NetBanking.</h2>
      <div class="tabs" id="tabs">
        <button data-cat="all" class="tab active">All</button>
        <button data-cat="ebooks" class="tab">E‑Books</button>
        <button data-cat="pdf" class="tab">PDF Notes</button>
        <button data-cat="software" class="tab">Software Tools</button>
        <button data-cat="courses" class="tab">Courses / Bundles</button>
      </div>
    </div>
  </section>
  <section id="sections" class="section">
    <div class="container">
      <h3>Products</h3>
      <div id="productGrid" class="grid"></div>
    </div>
  </section>
  <section id="how-to-pay" class="section">
    <div class="container">
      <h3>Payments & Delivery</h3>
      <div class="card"><div class="body">
        <div class="title">Razorpay Checkout (Recommended)</div>
        <p class="meta">Buy now opens Razorpay secure checkout. On success we verify signature and unlock a 1‑hour download link.</p>
      </div></div>
    </div>
  </section>
  <footer class="footer"><div class="tag">© <span id="yr"></span> DigiCart. All rights reserved.</div></footer>
  <!-- PREVIEW MODAL with 1‑hour timer (starts when opened) -->
  <dialog id="previewDialog">
    <div class="modal">
      <div class="head"><strong id="pvTitle">Preview</strong><button id="pvClose" class="btn ghost">Close</button></div>
      <div class="content">
        <p id="pvDesc" class="meta">—</p>
        <div class="timer"><span class="pill">Time left: <span id="pvTime">60:00</span></span><span class="tag">Preview auto‑locks after 1 hour</span></div>
        <div style="margin-top:12px">
          <a id="pvDownload" class="btn" target="_blank" rel="noopener">Download sample</a>
          <a id="pvBuy" class="btn ghost" href="#">Buy now</a>
        </div>
        <div id="pvEmbedWrap" style="margin-top:14px;border:1px solid rgba(245,197,66,.15);border-radius:12px;overflow:hidden">
          <iframe id="pvEmbed" src="about:blank" style="width:100%;height:420px;border:0;background:#0e0e12"></iframe>
        </div>
      </div>
    </div>
  </dialog>
  <script>
    // Catalog for UI (amount only used on server)
    const PRODUCTS = [
      { id:'eb-js-beg', cat:'ebooks', title:'JavaScript for Beginners (e‑Book)', desc:'200+ pages, projects, interview Q&A, lifetime updates.', price:199, tag:'Best Seller', type:'pdf', preview:'https://drive.google.com/file/d/YOUR_PREVIEW_ID1/preview', sample:'#' },
      { id:'eb-python-pro', cat:'ebooks', title:'Python Pro Handbook (e‑Book)', desc:'Hands‑on recipes, OOP, APIs, automation scripts.', price:249, tag:'Hot', type:'pdf', preview:'https://drive.google.com/file/d/YOUR_PREVIEW_ID2/preview', sample:'#' },
      { id:'pdf-dsa-kit', cat:'pdf', title:'DSA Crash Kit (PDF Notes)', desc:'Patterns, solutions, cheat tables, tracker CSV included.', price:179, tag:'New', type:'pdf', preview:'https://drive.google.com/file/d/YOUR_PREVIEW_ID3/preview', sample:'#' },
      { id:'sw-win-tool', cat:'software', title:'Win Optimizer Tool', desc:'One‑click clean, startup control, privacy guard.', price:299, tag:'Utility', type:'app', preview:'https://example.com/your-app-demo', sample:'#' },
      { id:'crs-web-bundle', cat:'courses', title:'Full Web Dev Bundle', desc:'HTML/CSS/JS + projects + assets. Save 40% vs single.', price:499, tag:'Bundle', type:'bundle', preview:'https://drive.google.com/file/d/YOUR_PREVIEW_ID4/preview', sample:'#' }
    ];
    const $ = s=>document.querySelector(s); const $$ = s=>document.querySelectorAll(s);
    const $grid = $('#productGrid'); const icons={ pdf:'<path d="M6 4h9l3 3v11a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2z"/>', bundle:'<path d="M4 6h16v12H4z"/>', app:'<path d="M7 3h10a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z"/>' };
    function card(p){ const el=document.createElement('div'); el.className='card'; el.innerHTML=`<div class="thumb"><svg viewBox="0 0 24 24">${icons[p.type]||icons.pdf}</svg></div>
      <span class="badge">${p.tag||'Digital'}</span>
      <div class="body">
        <div class="title">${p.title}</div>
        <div class="meta">${p.desc}</div>
        <div class="row">
          <div><div class="meta">Price</div><div class="price">₹${p.price}</div></div>
          <div style="display:flex;gap:10px">
            <a class="btn" href="#" data-buy="${p.id}">Buy now</a>
            <a class="btn ghost" href="#" data-preview="${p.id}">Preview</a>
          </div>
        </div>
      </div>`; el.querySelector('[data-preview]')?.addEventListener('click',(e)=>{e.preventDefault();openPreview(p)}); el.querySelector('[data-buy]')?.addEventListener('click', async (e)=>{e.preventDefault(); await launchCheckout(p.id)}); return el;}
    function render(cat='all'){ $grid.innerHTML=''; const list = PRODUCTS.filter(p=>cat==='all'?true:p.cat===cat); const f=document.createDocumentFragment(); list.forEach(p=>f.appendChild(card(p))); $grid.appendChild(f);}
    $$('#tabs .tab').forEach(t=>t.addEventListener('click',()=>{ $$('#tabs .tab').forEach(x=>x.classList.remove('active')); t.classList.add('active'); render(t.dataset.cat); }));
    // ==== Preview timer ====
    const dlg=$('#previewDialog'); const pvTitle=$('#pvTitle'); const pvDesc=$('#pvDesc'); const pvTime=$('#pvTime'); const pvBuy=$('#pvBuy'); const pvDl=$('#pvDownload'); const pvIframe=$('#pvEmbed');
    $('#pvClose').onclick=()=>dlg.close();
    let timerInt=null, expiryAt=null; const PREVIEW_MS=60*60*1000;
    function openPreview(p){ pvTitle.textContent=p.title; pvDesc.textContent=p.desc; pvDl.href=p.sample||'#'; pvIframe.src=p.preview; pvBuy.onclick=async (e)=>{e.preventDefault(); await launchCheckout(p.id)}; expiryAt=Date.now()+PREVIEW_MS; tick(); if(timerInt)clearInterval(timerInt); timerInt=setInterval(tick,1000); dlg.showModal(); }
    function tick(){ const left=Math.max(0, expiryAt-Date.now()); const m=Math.floor(left/60000), s=Math.floor((left%60000)/1000); pvTime.textContent=`${String(m).padStart(2,'0')}:${String(s).padStart(2,'0')}`; if(!left){ clearInterval(timerInt); pvDl.classList.add('disabled'); pvDl.textContent='Preview expired'; pvIframe.src='about:blank'; } }
    // ==== Checkout ==== (calls backend)
    async function launchCheckout(sku){
      const res = await fetch('/api/order', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ sku }) });
      const data = await res.json(); if(!data.ok) return alert(data.error||'Order failed');
      const options = {
        key: data.keyId,
        amount: data.amount,
        currency: data.currency,
        name: 'DigiCart',
        description: sku,
        order_id: data.orderId,
        prefill: { email: '' },
        theme: { color: '#f5c542' },
        handler: async function (resp){
          const verify = await fetch('/api/verify', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ sku, ...resp }) });
          const v = await verify.json(); if(!v.ok) return alert(v.error||'Verification failed');
          // redirect to thank you with download URL
          const next = new URL(window.location.origin + '/thank-you.html');
          next.searchParams.set('download', v.downloadUrl);
          window.location.href = next.toString();
        }
      };
      const rzp = new window.Razorpay(options);
      rzp.open();
    }
    render('all');
    document.getElementById('yr').textContent=new Date().getFullYear();
  </script>
  <!-- Razorpay Checkout SDK -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
</body>
</html>
